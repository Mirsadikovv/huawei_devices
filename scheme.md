# Что такое MCU, SMC, RSE и другие компоненты Huawei Video Conference?

## Основные компоненты системы видеоконференцсвязи Huawei

| **Компонент** | **Полное название** | **Описание** |
|---------------|----------------------|-------------|
| **SMC** | **SoftCo Management Center** | Центральная система управления видеоконференциями. Через SMC администраторы и разработчики управляют конференциями, устройствами, терминалами и интеграциями. API SMC позволяет автоматизировать планирование, контроль и мониторинг. |
| **MCU** | **Multipoint Control Unit** | Аппаратный или программный сервер, который объединяет видеопотоки от нескольких участников в одну конференцию. MCU микширует аудио/видео, поддерживает трансляции, запись и масштабирование (HD/SD). |
| **RSE** | **Recording & Streaming Engine** | Сервер записи и трансляции. Сохраняет конференции в виде файлов (MP4), поддерживает live-стриминг и VOD (видео по запросу). RSE8800A — аппаратная модель с API для скачивания записей. |
| **SC** | **Switch Center** | Коммутатор сигнализации (SIP/H.323). Управляет регистрацией терминалов, маршрутизацией вызовов и зонами. Обеспечивает связь между SMC, MCU и терминалами. |
| **CTI** | **Computer Telephony Integration** | Интеграция с телефонными платформами. Через CTI внешние системы (например, CRM) могут запрашивать записи с RSE по `ticket`. |
| **Terminal / Endpoint** | **Видеотерминал** | Устройство участника (например, Huawei TE50, Room Presence, настольный клиент). Подключается к MCU через SC. SMC управляет ими: обновления, логи, группы. |

---

## Как всё связано (архитектура)

```
┌─────────────────────────┐
│ Пользователь/Приложение │
└───────────┬─────────────┘
            │ API
            ▼
      ┌─────────┐
      │   SMC   │ (Центральное управление)
      └────┬────┘
           │
     ┌─────┼─────┬─────────┐
     │     │     │         │
     ▼     ▼     ▼         ▼
  ┌─────┐ ┌───┐ ┌─────┐  ┌───────────┐
  │ MCU │ │SC │ │ RSE │  │Терминалы  │
  └──┬──┘ └─┬─┘ └──┬──┘  └─────┬─────┘
     │      │      │           │
     │      └──────┼───────────┘
     │  Сигнализ.  │  Видеопоток
     │             │
     └─────────────┘
      Запись/Стрим

┌─────────────┐
│CTI Платформа│──ticket──> RSE
└─────────────┘
```

**Связи:**
- `Пользователь/Приложение` → `SMC` (API для управления)
- `SMC` → `MCU/SC/RSE/Терминалы` (управление всеми компонентами)
- `MCU` → `Терминалы` (передача видеопотока)
- `RSE` ← `MCU` (запись и стриминг)
- `SC` → `Терминалы` (сигнализация SIP/H.323)
- `CTI Платформа` → `RSE` (запрос записей по ticket)

---

## Последовательность работы (от создания конференции до скачивания записи)

```
┌────────┐                ┌─────┐                ┌─────┐
│ Клиент │                │ SMC │                │ MCU │
└───┬────┘                └──┬──┘                └──┬──┘
    │                        │                      │
    │ 1. POST /login         │                      │
    │───────────────────────>│                      │
    │                        │                      │
    │    JSESSIONID          │                      │
    │<───────────────────────│                      │
    │                        │                      │
    │ 2. POST /conferences   │                      │
    │───────────────────────>│                      │
    │                        │                      │
    │    confId              │                      │
    │<───────────────────────│                      │
    │                        │                      │
    │                        │ Выделить ресурсы     │
    │                        │─────────────────────>│
    │                        │                      │
    │                        │                   ┌─────┐
    │                        │ Начать запись     │ RSE │
    │                        │──────────────────>│     │
    │                        │                   └──┬──┘
    │                        │                      │
┌──────────┐               ┌───┐                    │
│ Участник │               │SC │                    │
└────┬─────┘               └─┬─┘                    │
     │                       │                      │
     │ Регистрация (SIP)     │                      │
     │──────────────────────>│                      │
     │                       │                      │
     │                       │ Перенаправить вызов  │
     │                       │─────────────────────>│
     │                                              │
     │        RTP-поток (видео/аудио)               │
     │─────────────────────────────────────────────>│
     │                                              │
     │                                              │
     │                               Поток на запись│
     │                               ┌──────────────┘
     │                               │
     │                               ▼
     │                          ┌─────────┐
     │                          │   RSE   │
     │                          │Сегмент  │
     │                          │  MP4    │
     │                          └─────────┘
     │
     │
┌────────┐                ┌─────┐
│ Клиент │                │ SMC │
└───┬────┘                └──┬──┘
    │                        │
    │ GET /conferences/      │
    │ {id}/record/stop       │
    │───────────────────────>│
    │                        │
    │
    │
┌─────────┐                          ┌─────┐
│   CTI   │                          │ RSE │
└────┬────┘                          └──┬──┘
     │                                  │
     │ GET /guestInfo?ticket=...        │
     │─────────────────────────────────>│
     │                                  │
     │    guest_user + pass             │
     │<─────────────────────────────────│
     │                                  │
     │ POST /login                      │
     │─────────────────────────────────>│
     │                                  │
     │ POST /bandwidth/apply            │
     │─────────────────────────────────>│
     │                                  │
     │ GET /recording/{confId}/segment/1│
     │─────────────────────────────────>│
     │                                  │
     │    MP4-сегмент                   │
     │<─────────────────────────────────│
     │                                  │
     │ POST /logout                     │
     │─────────────────────────────────>│
     │                                  │
```